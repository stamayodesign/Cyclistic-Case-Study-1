---
title: "Cyclistic Case Study"
author: "Steve Tamayo"
date: "2023-09-03"
output:
  html_document: default
---

```{r setup, include=FALSE}
#rm(list=ls()) #reset environment
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
library(tidyverse)  #helps wrangle data
library(lubridate)  #helps wrangle date attributes
library(ggplot2)  #helps visualize data
library(scales) #helps manage scale of data
library(tidyr)
library(knitr) # for report tables
library(kableExtra)
library(hms)
```

## <a name="toc" />Introduction

This is a report for the Case Study 1 of the Coursera Google Data Analytics Capstone.

## Table of Contents
[i. Business Task Statement](#pti)</br>
[A. Data Sources](#ptA)</br>
[B. Cleaning Documentation](#ptB)</br>
[C. Analysis](#ptC)</br>
[D. Additional Supporting Visualizations](#ptD)</br>
[E. Recommendations](#ptE)</br>
[F. Appendix](#ptF)</br>

## <a name="pti"/>Business Task Statement

#### "How do annual members and casual riders use Cyclistic bikes differently?"
Cyclistic is a (fictional) bike-share company in Chicago. In order to maximize the number of annual memberships, the team wants to understand the difference between casual riders (also referred to as "casual customer" or "casual rider") and annual members (also referred to as "member").

[Jump to Top](#toc)<br/>

## <a name="ptA" />A. Data Sources
The data is downloaded from <a href="https://divvy-tripdata.s3.amazonaws.com/index.html">this website</a> as zip files. The data has been provided according to the Divvy Data License Agreement. You can read more on <a href="https://divvybikes.com/system-data">their website</a>.

For this report, I have chosen to look at a complete year of data. As of this writing this report, the latest full year of data is from 2022.  

The raw data for each month in 2022 was downloaded and placed in a folder labeled "Raw Data" in the project main folder.

[Jump to Top](#toc)<br/>

## <a name="ptB"/>B. Cleaning Documentation
### B.1 Excel Cleaning
After downloading the zip files, I unzipped the csv files and copied them to a new folder labeled CSV. I further copied these files to a file labeled "Prepared Data" to prepare them processing.

Given the sizes of some of these files, spreadsheets was ruled out to handle the data as the June, July, and August reports were unable to be opened. However, they were processed in excel and then R.

For all 12 CSVs, the following process was conducted:

1. The file was opened in Excel.
2. Columns I, J, K, and L were removed. These columns were determined to not be relevant to this business task.
3. A new column J was labeled "length_of_trip"
4. J2 was filled with "=D2-C2" to get the length of the trip. This was then applied to all rows.
5. A new column K was labeled "day_of_week"
6. K2 was filled with "=WEEKDAY(C2,1)" to get the day the trip started. The "1" signifies that the numbering starts on "Sunday" with "1" and ends with "Saturday" with "7". This was then applied to all rows.
7. Column K was then Formatted with the Custom h:mm:ss to get the format to where it was needed for analysis.
8. The sheet was then sorted "smallest to largest" to determine if there were any lengths that were in the negatives. 
9. The rows that had negatives were adjusted by switching their start and end times. Double check that the J column was still "end-start"
10. The sheet was then resorted by "started_at" (column C)
11. Columns J and K were then copied then pasted with just the values.
12. Finally, the CSV was renamed, appending "_Prepped" to the original file name. Example: "202201-divvy0tripdata" became "202201-divvy0tripdata_Prepped"

Following those 12 steps for the 12 CSVs, I loaded them into a new RStudio project.

```{r Load CSVs, include=TRUE}
jan_2022 <- read_csv("202201-divvy-tripdata_Prepped.csv")
feb_2022 <- read_csv("202202-divvy-tripdata_Prepped.csv")
mar_2022 <- read_csv("202203-divvy-tripdata_Prepped.csv")
apr_2022 <- read_csv("202204-divvy-tripdata_Prepped.csv")
may_2022 <- read_csv("202205-divvy-tripdata_Prepped.csv")
jun_2022 <- read_csv("202206-divvy-tripdata_Prepped.csv")
jul_2022 <- read_csv("202207-divvy-tripdata_Prepped.csv")
aug_2022 <- read_csv("202208-divvy-tripdata_Prepped.csv")
sep_2022 <- read_csv("202209-divvy-tripdata_Prepped.csv")
oct_2022 <- read_csv("202210-divvy-tripdata_Prepped.csv")
nov_2022 <- read_csv("202211-divvy-tripdata_Prepped.csv")
dec_2022 <- read_csv("202212-divvy-tripdata_Prepped.csv")
```


### B.2 R Cleaning

Upon loading the CSVs into R Studio, I came across a problem. Certain values of "length_of_trip" were being converted to N/A's. Investigating revealed that these values were not converting into the ISO8601 date format R was expecting. Looking further into the CSVs in Excel, these trip lengths were over a week long and therefore were determined to be outliers. Additionally, there were a number of trips that had 0 length. I conducted additional cleaning in R by creating the following function:

```{r Function remove_outliers}
## Removes N/A, Trips with 0 length, and assigns the length of trip to a format accepted in R
remove_outliers = function(input_dataframe){
  tmp_df <- drop_na(input_dataframe,length_of_trip)
  tmp_df2 <- cbind(tmp_df,length_of_trip_r = as.POSIXct(tmp_df$length_of_trip,format="%H:%M:%S"))
  return <- subset(tmp_df2,length_of_trip_r > 0)
}
```

This function was then applied to each loaded file and assigned a new variable.

```{r Clean Prepared Excel Data}
jan_2022_clean <- remove_outliers(jan_2022)
feb_2022_clean <- remove_outliers(feb_2022)
mar_2022_clean <- remove_outliers(mar_2022)
apr_2022_clean <- remove_outliers(apr_2022)
may_2022_clean <- remove_outliers(may_2022)
jun_2022_clean <- remove_outliers(jun_2022)
jul_2022_clean <- remove_outliers(jul_2022)
aug_2022_clean <- remove_outliers(aug_2022)
sep_2022_clean <- remove_outliers(sep_2022)
oct_2022_clean <- remove_outliers(oct_2022)
nov_2022_clean <- remove_outliers(nov_2022)
dec_2022_clean <- remove_outliers(dec_2022)
```

[Jump to Top](#toc)<br/>

## <a name="ptC"/>C. Analysis
### <a name="Ref1" />C.1 Starting Tables
Now that the data is cleaned, it was time to aggregate the data into something more manageable. I created several functions to help with this process. The full code can be found in the [Appendix here](#Appx1).

```{r Analysis Functions, include=FALSE}

# Function - Filters member status and day of the week
filter_mc_dow = function(input_cleandata,input_MC,input_dow){
  return <- subset(select(input_cleandata, ride_id,rideable_type,length_of_trip,day_of_week,member_casual,length_of_trip_r),
                   member_casual==input_MC & day_of_week==input_dow)
}

# Function - Handle Quantile data
## Get all Quantile data and put it into a dataframe
create_df_q_data <- function(input_cleandata,input_MC){
  
  # Get quantile for each day
  tmp_quantile_1 <- quantile(filter_mc_dow(input_cleandata,input_MC,1)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_2 <- quantile(filter_mc_dow(input_cleandata,input_MC,2)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_3 <- quantile(filter_mc_dow(input_cleandata,input_MC,3)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_4 <- quantile(filter_mc_dow(input_cleandata,input_MC,4)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_5 <- quantile(filter_mc_dow(input_cleandata,input_MC,5)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_6 <- quantile(filter_mc_dow(input_cleandata,input_MC,6)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_7 <- quantile(filter_mc_dow(input_cleandata,input_MC,7)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  
  return <- data.frame(day_of_week = c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat"),
                       day_of_week_num = c(1:7),
                       Q1 = c(
                         tmp_quantile_1[2],
                         tmp_quantile_2[2],
                         tmp_quantile_3[2],
                         tmp_quantile_4[2],
                         tmp_quantile_5[2],
                         tmp_quantile_6[2],
                         tmp_quantile_7[2]
                       ),
                       Q2 = c(
                         tmp_quantile_1[3],
                         tmp_quantile_2[3],
                         tmp_quantile_3[3],
                         tmp_quantile_4[3],
                         tmp_quantile_5[3],
                         tmp_quantile_6[3],
                         tmp_quantile_7[3]
                       ),
                       Q3 = c(
                         tmp_quantile_1[4],
                         tmp_quantile_2[4],
                         tmp_quantile_3[4],
                         tmp_quantile_4[4],
                         tmp_quantile_5[4],
                         tmp_quantile_6[4],
                         tmp_quantile_7[4]
                       ),
                       Q4 = c(
                         tmp_quantile_1[5],
                         tmp_quantile_2[5],
                         tmp_quantile_3[5],
                         tmp_quantile_4[5],
                         tmp_quantile_5[5],
                         tmp_quantile_6[5],
                         tmp_quantile_7[5]
                       )
                       )
}

# Function - Create table of number of trips
create_df_num_of_trips <- function(input_cleandata,input_MorC){
  return <- data.frame(day_of_week = c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat"),
                       num_of_trips = c(nrow(filter_mc_dow(input_cleandata,input_MorC,1)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,2)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,3)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,4)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,5)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,6)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,7))
                       )
  )
}
# Function - Create a table of number of trips that less than Q2
create_df_num_of_trips_q <- function(input_cleandata,input_MorC,input_q){
  
  
  tmp_filter_data_MorC1 <-filter_mc_dow(input_cleandata,input_MorC,1)
  tmp_filter_data_MorC2 <-filter_mc_dow(input_cleandata,input_MorC,2)
  tmp_filter_data_MorC3 <-filter_mc_dow(input_cleandata,input_MorC,3)
  tmp_filter_data_MorC4 <-filter_mc_dow(input_cleandata,input_MorC,4)
  tmp_filter_data_MorC5 <-filter_mc_dow(input_cleandata,input_MorC,5)
  tmp_filter_data_MorC6 <-filter_mc_dow(input_cleandata,input_MorC,6)
  tmp_filter_data_MorC7 <-filter_mc_dow(input_cleandata,input_MorC,7)
  
  # Get quantile for each day
  tmp_quantile_1 <- quantile(filter_mc_dow(input_cleandata,input_MorC,1)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_2 <- quantile(filter_mc_dow(input_cleandata,input_MorC,2)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_3 <- quantile(filter_mc_dow(input_cleandata,input_MorC,3)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_4 <- quantile(filter_mc_dow(input_cleandata,input_MorC,4)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_5 <- quantile(filter_mc_dow(input_cleandata,input_MorC,5)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_6 <- quantile(filter_mc_dow(input_cleandata,input_MorC,6)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_7 <- quantile(filter_mc_dow(input_cleandata,input_MorC,7)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  
  
  return <- data.frame(day_of_week = c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat"),
                       num_of_trips = c(sum(tmp_filter_data_MorC1$length_of_trip_r <= tmp_quantile_1[input_q]),
                                        sum(tmp_filter_data_MorC2$length_of_trip_r <= tmp_quantile_2[input_q]),
                                        sum(tmp_filter_data_MorC3$length_of_trip_r <= tmp_quantile_3[input_q]),
                                        sum(tmp_filter_data_MorC4$length_of_trip_r <= tmp_quantile_4[input_q]),
                                        sum(tmp_filter_data_MorC5$length_of_trip_r <= tmp_quantile_5[input_q]),
                                        sum(tmp_filter_data_MorC6$length_of_trip_r <= tmp_quantile_6[input_q]),
                                        sum(tmp_filter_data_MorC7$length_of_trip_r <= tmp_quantile_7[input_q])
                                        )
                      )
}

# Function - Find Num of Bikes Used per day per type of user
## Writing a function to make finding bike values cleaner
find_bike_data <- function(input_clean_data_rideable_type,input_clean_data_member_casual,memberOrCasual,input_clean_data_day_of_week){
  return <- data.frame(day_of_week = c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat"),
                       classic_bike = c(sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 1),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 2),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 3),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 4),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 5),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 6),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 7)
                                        ),
                       docked_bike = c(sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 1),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 2),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 3),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 4),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 5),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 6),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 7)
                                       ),
                       electric_bike = c(sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 1),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 2),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 3),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 4),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 5),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 6),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 7)
                                       ),
                       total = c(sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 1),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 2),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 3),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 4),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 5),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 6),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 7)
                                      )
  )
}
```

<a name="Ref2" />
These functions were then able to be applied to all of the clean data. A master year data frame was also created and the functions applied to. Full code chunk is include in the [Appendix here](#Appx2).

```{r Applying Functions to Clean Data, include=FALSE}
# JANUARY
jan_2022_casual_df <- create_df_num_of_trips(jan_2022_clean,"casual")
jan_2022_member_df <- create_df_num_of_trips(jan_2022_clean,"member")
jan_2022_qAll_casual_df <- create_df_q_data(jan_2022_clean,"casual")
jan_2022_qAll_member_df <- create_df_q_data(jan_2022_clean,"member")
jan_2022_q2_casual_df <- create_df_num_of_trips_q(jan_2022_clean,"casual",3)
jan_2022_q2_member_df <- create_df_num_of_trips_q(jan_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
jan_2022_bike_type_Casual_df <- find_bike_data(jan_2022_clean$rideable_type,jan_2022_clean$member_casual,"casual",jan_2022_clean$day_of_week)
jan_2022_bike_type_Member_df <- find_bike_data(jan_2022_clean$rideable_type,jan_2022_clean$member_casual,"member",jan_2022_clean$day_of_week)

# FEBRUARY
feb_2022_casual_df <- create_df_num_of_trips(feb_2022_clean,"casual")
feb_2022_member_df <- create_df_num_of_trips(feb_2022_clean,"member")
feb_2022_qAll_casual_df <- create_df_q_data(feb_2022_clean,"casual")
feb_2022_qAll_member_df <- create_df_q_data(feb_2022_clean,"member")
feb_2022_q2_casual_df <- create_df_num_of_trips_q(feb_2022_clean,"casual",3)
feb_2022_q2_member_df <- create_df_num_of_trips_q(feb_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
feb_2022_bike_type_Casual_df <- find_bike_data(feb_2022_clean$rideable_type,feb_2022_clean$member_casual,"casual",feb_2022_clean$day_of_week)
feb_2022_bike_type_Member_df <- find_bike_data(feb_2022_clean$rideable_type,feb_2022_clean$member_casual,"member",feb_2022_clean$day_of_week)


# MARCH
mar_2022_casual_df <- create_df_num_of_trips(mar_2022_clean,"casual")
mar_2022_member_df <- create_df_num_of_trips(mar_2022_clean,"member")
mar_2022_qAll_casual_df <- create_df_q_data(mar_2022_clean,"casual")
mar_2022_qAll_member_df <- create_df_q_data(mar_2022_clean,"member")
mar_2022_q2_casual_df <- create_df_num_of_trips_q(mar_2022_clean,"casual",3)
mar_2022_q2_member_df <- create_df_num_of_trips_q(mar_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
mar_2022_bike_type_Casual_df <- find_bike_data(mar_2022_clean$rideable_type,mar_2022_clean$member_casual,"casual",mar_2022_clean$day_of_week)
mar_2022_bike_type_Member_df <- find_bike_data(mar_2022_clean$rideable_type,mar_2022_clean$member_casual,"member",mar_2022_clean$day_of_week)

# APRIL
apr_2022_casual_df <- create_df_num_of_trips(apr_2022_clean,"casual")
apr_2022_member_df <- create_df_num_of_trips(apr_2022_clean,"member")
apr_2022_qAll_casual_df <- create_df_q_data(apr_2022_clean,"casual")
apr_2022_qAll_member_df <- create_df_q_data(apr_2022_clean,"member")
apr_2022_q2_casual_df <- create_df_num_of_trips_q(apr_2022_clean,"casual",3)
apr_2022_q2_member_df <- create_df_num_of_trips_q(apr_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
apr_2022_bike_type_Casual_df <- find_bike_data(apr_2022_clean$rideable_type,apr_2022_clean$member_casual,"casual",apr_2022_clean$day_of_week)
apr_2022_bike_type_Member_df <- find_bike_data(apr_2022_clean$rideable_type,apr_2022_clean$member_casual,"member",apr_2022_clean$day_of_week)


# MAY
may_2022_casual_df <- create_df_num_of_trips(may_2022_clean,"casual")
may_2022_member_df <- create_df_num_of_trips(may_2022_clean,"member")
may_2022_qAll_casual_df <- create_df_q_data(may_2022_clean,"casual")
may_2022_qAll_member_df <- create_df_q_data(may_2022_clean,"member")
may_2022_q2_casual_df <- create_df_num_of_trips_q(may_2022_clean,"casual",3)
may_2022_q2_member_df <- create_df_num_of_trips_q(may_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
may_2022_bike_type_Casual_df <- find_bike_data(may_2022_clean$rideable_type,may_2022_clean$member_casual,"casual",may_2022_clean$day_of_week)
may_2022_bike_type_Member_df <- find_bike_data(may_2022_clean$rideable_type,may_2022_clean$member_casual,"member",may_2022_clean$day_of_week)


# JUNE
jun_2022_casual_df <- create_df_num_of_trips(jun_2022_clean,"casual")
jun_2022_member_df <- create_df_num_of_trips(jun_2022_clean,"member")
jun_2022_qAll_casual_df <- create_df_q_data(jun_2022_clean,"casual")
jun_2022_qAll_member_df <- create_df_q_data(jun_2022_clean,"member")
jun_2022_q2_casual_df <- create_df_num_of_trips_q(jun_2022_clean,"casual",3)
jun_2022_q2_member_df <- create_df_num_of_trips_q(jun_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
jun_2022_bike_type_Casual_df <- find_bike_data(jun_2022_clean$rideable_type,jun_2022_clean$member_casual,"casual",jun_2022_clean$day_of_week)
jun_2022_bike_type_Member_df <- find_bike_data(jun_2022_clean$rideable_type,jun_2022_clean$member_casual,"member",jun_2022_clean$day_of_week)


# JULY
jul_2022_casual_df <- create_df_num_of_trips(jul_2022_clean,"casual")
jul_2022_member_df <- create_df_num_of_trips(jul_2022_clean,"member")
jul_2022_qAll_casual_df <- create_df_q_data(jul_2022_clean,"casual")
jul_2022_qAll_member_df <- create_df_q_data(jul_2022_clean,"member")
jul_2022_q2_casual_df <- create_df_num_of_trips_q(jul_2022_clean,"casual",3)
jul_2022_q2_member_df <- create_df_num_of_trips_q(jul_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
jul_2022_bike_type_Casual_df <- find_bike_data(jul_2022_clean$rideable_type,jul_2022_clean$member_casual,"casual",jul_2022_clean$day_of_week)
jul_2022_bike_type_Member_df <- find_bike_data(jul_2022_clean$rideable_type,jul_2022_clean$member_casual,"member",jul_2022_clean$day_of_week)


# AUGUST
aug_2022_casual_df <- create_df_num_of_trips(aug_2022_clean,"casual")
aug_2022_member_df <- create_df_num_of_trips(aug_2022_clean,"member")
aug_2022_qAll_casual_df <- create_df_q_data(aug_2022_clean,"casual")
aug_2022_qAll_member_df <- create_df_q_data(aug_2022_clean,"member")
aug_2022_q2_casual_df <- create_df_num_of_trips_q(aug_2022_clean,"casual",3)
aug_2022_q2_member_df <- create_df_num_of_trips_q(aug_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
aug_2022_bike_type_Casual_df <- find_bike_data(aug_2022_clean$rideable_type,aug_2022_clean$member_casual,"casual",aug_2022_clean$day_of_week)
aug_2022_bike_type_Member_df <- find_bike_data(aug_2022_clean$rideable_type,aug_2022_clean$member_casual,"member",aug_2022_clean$day_of_week)


# SEPTEMBER
sep_2022_casual_df <- create_df_num_of_trips(sep_2022_clean,"casual")
sep_2022_member_df <- create_df_num_of_trips(sep_2022_clean,"member")
sep_2022_qAll_casual_df <- create_df_q_data(sep_2022_clean,"casual")
sep_2022_qAll_member_df <- create_df_q_data(sep_2022_clean,"member")
sep_2022_q2_casual_df <- create_df_num_of_trips_q(sep_2022_clean,"casual",3)
sep_2022_q2_member_df <- create_df_num_of_trips_q(sep_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
sep_2022_bike_type_Casual_df <- find_bike_data(sep_2022_clean$rideable_type,sep_2022_clean$member_casual,"casual",sep_2022_clean$day_of_week)
sep_2022_bike_type_Member_df <- find_bike_data(sep_2022_clean$rideable_type,sep_2022_clean$member_casual,"member",sep_2022_clean$day_of_week)


# OCTOBER
oct_2022_casual_df <- create_df_num_of_trips(oct_2022_clean,"casual")
oct_2022_member_df <- create_df_num_of_trips(oct_2022_clean,"member")
oct_2022_qAll_casual_df <- create_df_q_data(oct_2022_clean,"casual")
oct_2022_qAll_member_df <- create_df_q_data(oct_2022_clean,"member")
oct_2022_q2_casual_df <- create_df_num_of_trips_q(oct_2022_clean,"casual",3)
oct_2022_q2_member_df <- create_df_num_of_trips_q(oct_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
oct_2022_bike_type_Casual_df <- find_bike_data(oct_2022_clean$rideable_type,oct_2022_clean$member_casual,"casual",oct_2022_clean$day_of_week)
oct_2022_bike_type_Member_df <- find_bike_data(oct_2022_clean$rideable_type,oct_2022_clean$member_casual,"member",oct_2022_clean$day_of_week)

# NOVEMBER
nov_2022_casual_df <- create_df_num_of_trips(nov_2022_clean,"casual")
nov_2022_member_df <- create_df_num_of_trips(nov_2022_clean,"member")
nov_2022_qAll_casual_df <- create_df_q_data(nov_2022_clean,"casual")
nov_2022_qAll_member_df <- create_df_q_data(nov_2022_clean,"member")
nov_2022_q2_casual_df <- create_df_num_of_trips_q(nov_2022_clean,"casual",3)
nov_2022_q2_member_df <- create_df_num_of_trips_q(nov_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
nov_2022_bike_type_Casual_df <- find_bike_data(nov_2022_clean$rideable_type,nov_2022_clean$member_casual,"casual",nov_2022_clean$day_of_week)
nov_2022_bike_type_Member_df <- find_bike_data(nov_2022_clean$rideable_type,nov_2022_clean$member_casual,"member",nov_2022_clean$day_of_week)

# DECEMBER
dec_2022_casual_df <- create_df_num_of_trips(dec_2022_clean,"casual")
dec_2022_member_df <- create_df_num_of_trips(dec_2022_clean,"member")
dec_2022_qAll_casual_df <- create_df_q_data(dec_2022_clean,"casual")
dec_2022_qAll_member_df <- create_df_q_data(dec_2022_clean,"member")
dec_2022_q2_casual_df <- create_df_num_of_trips_q(dec_2022_clean,"casual",3)
dec_2022_q2_member_df <- create_df_num_of_trips_q(dec_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
dec_2022_bike_type_Casual_df <- find_bike_data(dec_2022_clean$rideable_type,dec_2022_clean$member_casual,"casual",dec_2022_clean$day_of_week)
dec_2022_bike_type_Member_df <- find_bike_data(dec_2022_clean$rideable_type,dec_2022_clean$member_casual,"member",dec_2022_clean$day_of_week)

# 2022
year_2022_clean <- rbind(jan_2022_clean, feb_2022_clean, mar_2022_clean, apr_2022_clean, 
                         may_2022_clean, jun_2022_clean, jul_2022_clean, aug_2022_clean, 
                         sep_2022_clean, oct_2022_clean, nov_2022_clean, dec_2022_clean)
year_2022_casual_df <- create_df_num_of_trips(year_2022_clean,"casual")
year_2022_member_df <- create_df_num_of_trips(year_2022_clean,"member")
year_2022_qAll_casual_df <- create_df_q_data(year_2022_clean,"casual")
year_2022_qAll_member_df <- create_df_q_data(year_2022_clean,"member")
year_2022_q2_casual_df <- create_df_num_of_trips_q(year_2022_clean,"casual",3)
year_2022_q2_member_df <- create_df_num_of_trips_q(year_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
year_2022_bike_type_Casual_df <- find_bike_data(year_2022_clean$rideable_type,year_2022_clean$member_casual,"casual",year_2022_clean$day_of_week)
year_2022_bike_type_Member_df <- find_bike_data(year_2022_clean$rideable_type,year_2022_clean$member_casual,"member",year_2022_clean$day_of_week)
```

```{r Year 2022 Clean, First 6 rows, echo=FALSE}
kable(head(year_2022_clean),caption = "Year 2022 Clean, First 10 rows") %>% 
  kable_styling()
```

Additional tables display the following for each month or the whole year (Displaying full year only):

1. Number of trips for each month by member status and bike_type (Casual & Member are separate)

```{r Example Number of Trips 2022 - Casual, echo=FALSE}
kable(year_2022_bike_type_Casual_df,caption = "Number of Trips, 2022 - Casual") %>% 
  kable_styling()
```

```{r Example Number of Trips 2022 - Member, echo=FALSE}
kable(year_2022_bike_type_Member_df,caption = "Number of Trips, 2022 - Member") %>% 
  kable_styling()
```

2. Quantiles of the length of trips for each month by day of the week (Casual & Member are separate)*

```{r Example Quantiles 2022 - Casual, echo=FALSE}
kable(year_2022_qAll_casual_df,caption = "Quantiles for Length of Trip, 2022 - Casual") %>% 
  kable_styling()
```

```{r Example Quantiles 2022 - Member, echo=FALSE}
kable(year_2022_qAll_member_df,caption = "Quantiles for Length of Trip, 2022 - Member") %>% 
  kable_styling()
```

*Separate tables for just the second Quantile, 50% and below of trips, were also created for analysis purpose. 

3. Additional tables to be used by functions (Not displayed for convenience, but found in the [Appendix here](#Appx2))

### <a name="Ref3" />C.2 Trends and Relationships

The next step was to find trends in the data. 

#### <a name="Ref2" />C.2.a Trip Frequency
The first thing I wanted to check was how many trips per month casual and member customers accrued. The code can be found in the [Appendix here](#Appx3).

```{r Year 2022 Customers Trip Frequency, include=FALSE}
df_customer_numOfTrip_vMonth <- data.frame(customer_type = rep(c("casual","member"),each=12),
                                           monthNum = rep(as.factor(c(1:12)),2),
                                           num_of_trips = c(sum(jan_2022_casual_df$num_of_trips),
                                             sum(feb_2022_casual_df$num_of_trips),
                                             sum(mar_2022_casual_df$num_of_trips),
                                             sum(apr_2022_casual_df$num_of_trips),
                                             sum(may_2022_casual_df$num_of_trips),
                                             sum(jun_2022_casual_df$num_of_trips),
                                             sum(jul_2022_casual_df$num_of_trips),
                                             sum(aug_2022_casual_df$num_of_trips),
                                             sum(sep_2022_casual_df$num_of_trips),
                                             sum(oct_2022_casual_df$num_of_trips),
                                             sum(nov_2022_casual_df$num_of_trips),
                                             sum(dec_2022_casual_df$num_of_trips),
                                             sum(jan_2022_member_df$num_of_trips),
                                             sum(feb_2022_member_df$num_of_trips),
                                             sum(mar_2022_member_df$num_of_trips),
                                             sum(apr_2022_member_df$num_of_trips),
                                             sum(may_2022_member_df$num_of_trips),
                                             sum(jun_2022_member_df$num_of_trips),
                                             sum(jul_2022_member_df$num_of_trips),
                                             sum(aug_2022_member_df$num_of_trips),
                                             sum(sep_2022_member_df$num_of_trips),
                                             sum(oct_2022_member_df$num_of_trips),
                                             sum(nov_2022_member_df$num_of_trips),
                                             sum(dec_2022_member_df$num_of_trips)
                                             )
                                          )

graph_year2022_tripfreq_customer <- ggplot(data=df_customer_numOfTrip_vMonth,aes(x=monthNum,y=num_of_trips, fill = customer_type)) +
  geom_bar(stat = "identity",width=.86,position=position_dodge(width=.9))+
  labs(title = "Year 2022 Customers' Trip Frequency",
       subtitle = "Number of Trips per month",
       x="Per Month",
       y="Number of Trips (K*)",
       caption="K stands for 1000") +
  scale_fill_discrete(name="Customer") +
  geom_text(aes(label = paste(c(floor(num_of_trips/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=2.75,hjust= 1,vjust=-.75,angle=-60) +
  scale_y_continuous(limits = c(0,500000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_discrete(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )
```

```{r View graph_year2022_tripfreq_customer, echo=FALSE}
graph_year2022_tripfreq_customer
```

The data shows that the number of trips for members peaked in August, while the number of trips for casual customers peaked a month earlier in July. And while the May to July data shows that there is a relatively equal amount of trips between casual customers and members, the rest of the year has far more members using the service compared to casual customers.

#### <a name="VizRef1" /><a name="Ref4" />C.2.b Bike Preferences 
The next trend to check was to see the difference between each bike type and how frequent each customer used each. The code can be found in the [Appendix here](#Appx4).

```{r Year 2022 Bike Preferences, include=FALSE}

yearByMonth_2022_bike_type_Casual_df <- data.frame(
  month = c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
  monthNum = c(1:12),
  classic_bike = c(
    sum(jan_2022_bike_type_Casual_df$classic_bike),
    sum(feb_2022_bike_type_Casual_df$classic_bike),
    sum(mar_2022_bike_type_Casual_df$classic_bike),
    sum(apr_2022_bike_type_Casual_df$classic_bike),
    sum(may_2022_bike_type_Casual_df$classic_bike),
    sum(jun_2022_bike_type_Casual_df$classic_bike),
    sum(jul_2022_bike_type_Casual_df$classic_bike),
    sum(aug_2022_bike_type_Casual_df$classic_bike),
    sum(sep_2022_bike_type_Casual_df$classic_bike),
    sum(oct_2022_bike_type_Casual_df$classic_bike),
    sum(nov_2022_bike_type_Casual_df$classic_bike),
    sum(dec_2022_bike_type_Casual_df$classic_bike)
  ) ,
  docked_bike = c(
    sum(jan_2022_bike_type_Casual_df$docked_bike),
    sum(feb_2022_bike_type_Casual_df$docked_bike),
    sum(mar_2022_bike_type_Casual_df$docked_bike),
    sum(apr_2022_bike_type_Casual_df$docked_bike),
    sum(may_2022_bike_type_Casual_df$docked_bike),
    sum(jun_2022_bike_type_Casual_df$docked_bike),
    sum(jul_2022_bike_type_Casual_df$docked_bike),
    sum(aug_2022_bike_type_Casual_df$docked_bike),
    sum(sep_2022_bike_type_Casual_df$docked_bike),
    sum(oct_2022_bike_type_Casual_df$docked_bike),
    sum(nov_2022_bike_type_Casual_df$docked_bike),
    sum(dec_2022_bike_type_Casual_df$docked_bike)
  ) ,
  electric_bike = c(
    sum(jan_2022_bike_type_Casual_df$electric_bike),
    sum(feb_2022_bike_type_Casual_df$electric_bike),
    sum(mar_2022_bike_type_Casual_df$electric_bike),
    sum(apr_2022_bike_type_Casual_df$electric_bike),
    sum(may_2022_bike_type_Casual_df$electric_bike),
    sum(jun_2022_bike_type_Casual_df$electric_bike),
    sum(jul_2022_bike_type_Casual_df$electric_bike),
    sum(aug_2022_bike_type_Casual_df$electric_bike),
    sum(sep_2022_bike_type_Casual_df$electric_bike),
    sum(oct_2022_bike_type_Casual_df$electric_bike),
    sum(nov_2022_bike_type_Casual_df$electric_bike),
    sum(dec_2022_bike_type_Casual_df$electric_bike)
  ),
  total = c( 
    sum(jan_2022_bike_type_Casual_df$classic_bike) + sum(jan_2022_bike_type_Casual_df$docked_bike) + sum(jan_2022_bike_type_Casual_df$electric_bike),
    sum(feb_2022_bike_type_Casual_df$classic_bike) + sum(feb_2022_bike_type_Casual_df$docked_bike) + sum(feb_2022_bike_type_Casual_df$electric_bike),
    sum(mar_2022_bike_type_Casual_df$classic_bike) + sum(mar_2022_bike_type_Casual_df$docked_bike) + sum(mar_2022_bike_type_Casual_df$electric_bike),
    sum(apr_2022_bike_type_Casual_df$classic_bike) + sum(apr_2022_bike_type_Casual_df$docked_bike) + sum(apr_2022_bike_type_Casual_df$electric_bike),
    sum(may_2022_bike_type_Casual_df$classic_bike) + sum(may_2022_bike_type_Casual_df$docked_bike) + sum(may_2022_bike_type_Casual_df$electric_bike),
    sum(jun_2022_bike_type_Casual_df$classic_bike) + sum(jun_2022_bike_type_Casual_df$docked_bike) + sum(jun_2022_bike_type_Casual_df$electric_bike),
    sum(jul_2022_bike_type_Casual_df$classic_bike) + sum(jul_2022_bike_type_Casual_df$docked_bike) + sum(jul_2022_bike_type_Casual_df$electric_bike),
    sum(aug_2022_bike_type_Casual_df$classic_bike) + sum(aug_2022_bike_type_Casual_df$docked_bike) + sum(aug_2022_bike_type_Casual_df$electric_bike),
    sum(sep_2022_bike_type_Casual_df$classic_bike) + sum(sep_2022_bike_type_Casual_df$docked_bike) + sum(sep_2022_bike_type_Casual_df$electric_bike),
    sum(oct_2022_bike_type_Casual_df$classic_bike) + sum(oct_2022_bike_type_Casual_df$docked_bike) + sum(oct_2022_bike_type_Casual_df$electric_bike),
    sum(nov_2022_bike_type_Casual_df$classic_bike) + sum(nov_2022_bike_type_Casual_df$docked_bike) + sum(nov_2022_bike_type_Casual_df$electric_bike),
    sum(dec_2022_bike_type_Casual_df$classic_bike) + sum(dec_2022_bike_type_Casual_df$docked_bike) + sum(dec_2022_bike_type_Casual_df$electric_bike)
  )
)

yearByMonth_2022_bike_type_Member_df <- data.frame(
  month = c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
  monthNum = c(1:12),
  classic_bike = c(
    sum(jan_2022_bike_type_Member_df$classic_bike),
    sum(feb_2022_bike_type_Member_df$classic_bike),
    sum(mar_2022_bike_type_Member_df$classic_bike),
    sum(apr_2022_bike_type_Member_df$classic_bike),
    sum(may_2022_bike_type_Member_df$classic_bike),
    sum(jun_2022_bike_type_Member_df$classic_bike),
    sum(jul_2022_bike_type_Member_df$classic_bike),
    sum(aug_2022_bike_type_Member_df$classic_bike),
    sum(sep_2022_bike_type_Member_df$classic_bike),
    sum(oct_2022_bike_type_Member_df$classic_bike),
    sum(nov_2022_bike_type_Member_df$classic_bike),
    sum(dec_2022_bike_type_Member_df$classic_bike)
  ) ,
  docked_bike = c(
    sum(jan_2022_bike_type_Member_df$docked_bike),
    sum(feb_2022_bike_type_Member_df$docked_bike),
    sum(mar_2022_bike_type_Member_df$docked_bike),
    sum(apr_2022_bike_type_Member_df$docked_bike),
    sum(may_2022_bike_type_Member_df$docked_bike),
    sum(jun_2022_bike_type_Member_df$docked_bike),
    sum(jul_2022_bike_type_Member_df$docked_bike),
    sum(aug_2022_bike_type_Member_df$docked_bike),
    sum(sep_2022_bike_type_Member_df$docked_bike),
    sum(oct_2022_bike_type_Member_df$docked_bike),
    sum(nov_2022_bike_type_Member_df$docked_bike),
    sum(dec_2022_bike_type_Member_df$docked_bike)
  ) ,
  electric_bike = c(
    sum(jan_2022_bike_type_Member_df$electric_bike),
    sum(feb_2022_bike_type_Member_df$electric_bike),
    sum(mar_2022_bike_type_Member_df$electric_bike),
    sum(apr_2022_bike_type_Member_df$electric_bike),
    sum(may_2022_bike_type_Member_df$electric_bike),
    sum(jun_2022_bike_type_Member_df$electric_bike),
    sum(jul_2022_bike_type_Member_df$electric_bike),
    sum(aug_2022_bike_type_Member_df$electric_bike),
    sum(sep_2022_bike_type_Member_df$electric_bike),
    sum(oct_2022_bike_type_Member_df$electric_bike),
    sum(nov_2022_bike_type_Member_df$electric_bike),
    sum(dec_2022_bike_type_Member_df$electric_bike)
  ),
  total = c( 
    sum(jan_2022_bike_type_Member_df$classic_bike) + sum(jan_2022_bike_type_Member_df$docked_bike) + sum(jan_2022_bike_type_Member_df$electric_bike),
    sum(feb_2022_bike_type_Member_df$classic_bike) + sum(feb_2022_bike_type_Member_df$docked_bike) + sum(feb_2022_bike_type_Member_df$electric_bike),
    sum(mar_2022_bike_type_Member_df$classic_bike) + sum(mar_2022_bike_type_Member_df$docked_bike) + sum(mar_2022_bike_type_Member_df$electric_bike),
    sum(apr_2022_bike_type_Member_df$classic_bike) + sum(apr_2022_bike_type_Member_df$docked_bike) + sum(apr_2022_bike_type_Member_df$electric_bike),
    sum(may_2022_bike_type_Member_df$classic_bike) + sum(may_2022_bike_type_Member_df$docked_bike) + sum(may_2022_bike_type_Member_df$electric_bike),
    sum(jun_2022_bike_type_Member_df$classic_bike) + sum(jun_2022_bike_type_Member_df$docked_bike) + sum(jun_2022_bike_type_Member_df$electric_bike),
    sum(jul_2022_bike_type_Member_df$classic_bike) + sum(jul_2022_bike_type_Member_df$docked_bike) + sum(jul_2022_bike_type_Member_df$electric_bike),
    sum(aug_2022_bike_type_Member_df$classic_bike) + sum(aug_2022_bike_type_Member_df$docked_bike) + sum(aug_2022_bike_type_Member_df$electric_bike),
    sum(sep_2022_bike_type_Member_df$classic_bike) + sum(sep_2022_bike_type_Member_df$docked_bike) + sum(sep_2022_bike_type_Member_df$electric_bike),
    sum(oct_2022_bike_type_Member_df$classic_bike) + sum(oct_2022_bike_type_Member_df$docked_bike) + sum(oct_2022_bike_type_Member_df$electric_bike),
    sum(nov_2022_bike_type_Member_df$classic_bike) + sum(nov_2022_bike_type_Member_df$docked_bike) + sum(nov_2022_bike_type_Member_df$electric_bike),
    sum(dec_2022_bike_type_Member_df$classic_bike) + sum(dec_2022_bike_type_Member_df$docked_bike) + sum(dec_2022_bike_type_Member_df$electric_bike)
  )
)

# Adjust Table for Bar Plot
yearByMonth_2022_bike_type_Casual_subgrouped_df <-data.frame(biketype = rep(c("classic","docked","electric"),each=12),
                                                             monthNum = rep(yearByMonth_2022_bike_type_Casual_df$monthNum,3),
                                                             num_of_bike = c(yearByMonth_2022_bike_type_Casual_df$classic_bike,
                                                                             yearByMonth_2022_bike_type_Casual_df$docked_bike,
                                                                             yearByMonth_2022_bike_type_Casual_df$electric_bike)
                                                             )

yearByMonth_2022_bike_type_Member_subgrouped_df <-data.frame(biketype = rep(c("classic","docked","electric"),each=12),
                                                             monthNum = rep(yearByMonth_2022_bike_type_Member_df$monthNum,3),
                                                             num_of_bike = c(yearByMonth_2022_bike_type_Member_df$classic_bike,
                                                                             yearByMonth_2022_bike_type_Member_df$docked_bike,
                                                                             yearByMonth_2022_bike_type_Member_df$electric_bike)
)

# Get Year By Month but remove docked
yearByMonth_2022_bike_type_Casual_subgrouped_sansDocked_df <-data.frame(biketype = rep(c("classic","electric"),each=12),
                                                             monthNum = rep(yearByMonth_2022_bike_type_Casual_df$monthNum,2),
                                                             num_of_bike = c(yearByMonth_2022_bike_type_Casual_df$classic_bike,
                                                                             yearByMonth_2022_bike_type_Casual_df$electric_bike)
)

# Get Year By Month but remove docked
yearByMonth_2022_bike_type_Member_subgrouped_sansDocked_df <-data.frame(biketype = rep(c("classic","electric"),each=12),
                                                                        monthNum = rep(yearByMonth_2022_bike_type_Member_df$monthNum,2),
                                                                        num_of_bike = c(yearByMonth_2022_bike_type_Member_df$classic_bike,
                                                                                        yearByMonth_2022_bike_type_Member_df$electric_bike)
)



```

```{r Year 2022 Bike Preferences Casual Plots, include = FALSE}
# Used to label plots
days_of_the_week <- c("Sunday", "Monday", "Tuesday", "Wednesday", 
                      "Thursday", "Friday", "Saturday")

# Year 2022 Bike Popularity for Casual Customers
graph_year2022casual_numOfBike_month_biketype <- ggplot(data=yearByMonth_2022_bike_type_Casual_subgrouped_df,aes(x=monthNum,y=num_of_bike, fill = biketype)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1))+
  labs(title = "Year 2022 Bike Popularity, Casual",
       subtitle = "Amount of each bike used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption = "*K stands for 1000") +
  #geom_text(aes(label = signif(num_of_bike)), nudge_y = 3) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )

# Year 2022 Bike Popularity for Casual Customers - Sans Docked
graph_year2022casual_numOfBike_month_biketype_sansDocked <- ggplot(data=yearByMonth_2022_bike_type_Casual_subgrouped_sansDocked_df,aes(x=monthNum,y=num_of_bike, fill = biketype)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1))+
  labs(title = "Year 2022 Bike Popularity, Casual**",
       subtitle = "Amount of either classic or electic bike used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption = "**This graph does not feature docked bikes, *K stands for 1000") +
  #geom_text(aes(label = signif(num_of_bike)), nudge_y = 3) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )+
  scale_fill_manual(values = c("#F8766D","#619CFF"))

# Individual
graph_year2022casual_numOfBike_month_classic <- ggplot(data=yearByMonth_2022_bike_type_Casual_df, aes(x=monthNum,y=classic_bike)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1), fill = "#F8766D")+
  labs(title = "Year 2022 Bike Popularity, Casual - Classic",
       subtitle = "Amount of classic bikes used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(classic_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 

graph_year2022casual_numOfBike_month_docked <- ggplot(data=yearByMonth_2022_bike_type_Casual_df, aes(x=monthNum,y=docked_bike)) +
  geom_bar(stat = "identity",width=0.9,position=position_dodge(width=1), fill="#00BA38")+
  labs(title = "Year 2022 Bike Popularity, Casual - Docked",
       subtitle = "Amount of docked bikes used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(docked_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 


graph_year2022casual_numOfBike_month_electric <- ggplot(data=yearByMonth_2022_bike_type_Casual_df, aes(x=monthNum,y=electric_bike)) +
  geom_bar(stat = "identity",width=0.9,position=position_dodge(width=1), fill="#619CFF")+
  labs(title = "Year 2022 Bike Popularity, Casual - Electric",
       subtitle = "Amount of electric bikes used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(electric_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 
```

```{r Year 2022 Bike Popularity Casual, echo=FALSE}
graph_year2022casual_numOfBike_month_biketype_sansDocked
graph_year2022casual_numOfBike_month_biketype
```

From these graphs, we can see that, aside from the month of May and June, casual riders use more electric bikes compared to classic. Furthermore, from July to December, there is a significant increase of electric bikes being used over classic bikes.

To see a deeper dive into this data, you can [click here](#MoreViz1) to view each bike with number labels.

```{r Year 2022 Bike Preferences Member Plots, include = FALSE}
# Year 2022 Bike Popularity for Member Customers
graph_year2022member_numOfBike_month_biketype <- ggplot(data=yearByMonth_2022_bike_type_Member_subgrouped_df,aes(x=monthNum,y=num_of_bike, fill = biketype)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1))+
  labs(title = "Year 2022 Bike Popularity, Member",
       subtitle = "Amount of each bike used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption = "*K stands for 1000") +
  #geom_text(aes(label = signif(num_of_bike)), nudge_y = 3) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )

# Year 2022 Bike Popularity for Member Customers - Sans Docked
graph_year2022member_numOfBike_month_biketype_sansDocked <- ggplot(data=yearByMonth_2022_bike_type_Member_subgrouped_sansDocked_df,aes(x=monthNum,y=num_of_bike, fill = biketype)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1))+
  labs(title = "Year 2022 Bike Popularity, Member**",
       subtitle = "Amount of either classic or electic bike used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption = "**This graph does not feature docked bikes, *K stands for 1000") +
  #geom_text(aes(label = signif(num_of_bike)), nudge_y = 3) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )+
  scale_fill_manual(values = c("#F8766D","#619CFF"))

# Individual
graph_year2022member_numOfBike_month_classic <- ggplot(data=yearByMonth_2022_bike_type_Member_df, aes(x=monthNum,y=classic_bike)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1), fill = "#F8766D")+
  labs(title = "Year 2022 Bike Popularity, Member - Classic",
       subtitle = "Amount of classic bikes used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(classic_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 

graph_year2022member_numOfBike_month_docked <- ggplot(data=yearByMonth_2022_bike_type_Member_df, aes(x=monthNum,y=docked_bike)) +
  geom_bar(stat = "identity",width=0.9,position=position_dodge(width=1), fill="#00BA38")+
  labs(title = "Year 2022 Bike Popularity, Member - Docked",
       subtitle = "Amount of docked bikes used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(docked_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 


graph_year2022member_numOfBike_month_electric <- ggplot(data=yearByMonth_2022_bike_type_Member_df, aes(x=monthNum,y=electric_bike)) +
  geom_bar(stat = "identity",width=0.9,position=position_dodge(width=1), fill="#619CFF")+
  labs(title = "Year 2022 Bike Popularity, Member - Electric",
       subtitle = "Amount of electric bikes used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(electric_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 

```

<a name="VizRef2" />
```{r Year 2022 Bike Preferences Member, echo=FALSE }
graph_year2022member_numOfBike_month_biketype_sansDocked
```

This data shows that classic bikes are used more compared to electric bikes in from January to August, but then electric bikes are used more often from September to December.

This graph does not feature docked bikes due to no reports of members using docked bikes. To see a deeper dive into this data, you can [click here](#MoreViz2) to view each bike with number labels.

#### <a name="Ref5"/>C.2.c Trip Length
The final trend I wanted to check was to see the common length of trip between the customer types. However, I didn't want to take the average of length of every trip, but instead use quantiles to get a more accurate look at the trip lengths without taking outliers into consideration. The code can be found in the [Appendix here](#Appx5).

```{r Year 2022 Q2 Bike Trip, Casual vs Member, echo=FALSE}
# Creating a function to properly display time
createTimeStamp = function(input_minute, input_second){
  temp_second = ifelse(input_second < 10,paste("0",input_second,sep = ""),
    as.character(input_second))
  return = paste(input_minute,temp_second,sep = ":")
}

year_2022_q2_df_fixed <- data.frame (member_casual = rep(c("casual","member"),each=7),
                                     day_of_week_num = c(year_2022_qAll_casual_df$day_of_week_num,year_2022_qAll_member_df$day_of_week_num),
                                     Q2 = c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2),
                                     Q2seconds = minute(c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2))*60+second(c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2)),
                                     Q2Text = createTimeStamp(c(minute(c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2))),
                                                              c(second(c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2)))
                                                              )
                                     )



ggplot(data=year_2022_q2_df_fixed,aes(x=day_of_week_num,y=Q2seconds, fill=member_casual))+
  geom_bar(stat = "identity",width=.86,position=position_dodge(width=.9)) +
  labs(title = "Year 2022 Q2 Bike Trip, Casual vs Member",
       subtitle = "The second quantile of casual and member rider's length of time",
       x="Day of the Week",
       y="Length of Trip (HH:MM:SS)")+
  geom_text(aes(label = Q2Text ),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.5,angle=0) +
  scale_y_time(limits = as.hms(c('00:00:00', '00:30:00')))+
  scale_x_continuous(
    breaks = seq_along(days_of_the_week), 
    labels = days_of_the_week
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  ) +
  scale_fill_manual(values = c("orange","violet"),name="Customer")


```

<a name="Ref6"/>
From this graph, the data shows that casual customers use the service 4 to 9 minutes longer than members do. From here, I remembered that members don't use docked bikes, so I plotted the Q2 trip lengths for casual customers only using docked bikes. The code can be found in the [Appendix here](#Appx6).

```{r Year 2022 Q2 Bike Trip, Casual - Docked, echo=FALSE}
## Let's Check docked Bikes Casual

year_2022_clean_casual_docked_bike <- subset(year_2022_clean,member_casual=="casual"& rideable_type=="docked_bike")

#nrow(year_2022_clean_casual_docked_bike) # 176372 
#nrow(subset(year_2022_clean,member_casual=="casual")) #2319783

year_2022_qAll_casual_docked_bike_df <- create_df_q_data(year_2022_clean_casual_docked_bike,"casual")

# Creating a function to properly display time, but this time it uses hour
createTimeStampWHH = function(input_hour,input_minute, input_second){
  temp_minute = ifelse(input_minute < 10,paste("0",input_minute,sep = ""),
                       as.character(input_minute))
  temp_second = ifelse(input_second < 10,paste("0",input_second,sep = ""),
                       as.character(input_second))
  return = ifelse(input_hour == 0,paste(input_minute,temp_second,sep = ":"),paste(input_hour,temp_minute,temp_second,sep = ":"))
    
}

year_2022_q2_casual_docked_bike_df <- data.frame(day_of_week_num = c(year_2022_qAll_casual_docked_bike_df$day_of_week_num),
                                           Q2 = c(year_2022_qAll_casual_docked_bike_df$Q2),
                                           Q2seconds = hour(c(year_2022_qAll_casual_docked_bike_df$Q2))*60*60+minute(c(year_2022_qAll_casual_docked_bike_df$Q2))*60+second(c(year_2022_qAll_casual_docked_bike_df$Q2)),
                                           Q2Text = createTimeStampWHH(c(hour(year_2022_qAll_casual_docked_bike_df$Q2)),
                                                                       c(minute(year_2022_qAll_casual_docked_bike_df$Q2)),
                                                                       c(second(year_2022_qAll_casual_docked_bike_df$Q2))
                                           )
)

ggplot(data=year_2022_q2_casual_docked_bike_df,aes(x=day_of_week_num,y=Q2seconds))+
  geom_bar(stat = "identity",width=.86,position=position_dodge(width=.9), fill="red") +
  labs(title = "Year 2022 Q2 Bike Trip, Casual - Docked",
       subtitle = "The second quantile of casual rider's length of time using docked bikes",
       x="Day of the Week",
       y="Length of Trip (HH:MM:SS)",
       legend="Customer")+
  geom_text(aes(label = Q2Text ),
            position = position_dodge2(width = 0.9, preserve = "single"),size=4.5,hjust= .5,vjust=-.5,angle=0) +
  scale_y_time(limits = as.hms(c('00:00:00', '1:10:00')))+
  scale_x_continuous(
    breaks = seq_along(days_of_the_week), 
    labels = days_of_the_week
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  ) 
```

<a name="Ref7"/>
The data shows a significant increase to the amount of time a casual customer uses the docked bikes. The following graph shows the comparison between the above graph and the member time from the graph before. The code can be found in the [Appendix here](#Appx7).

```{r Year 2022 Q2 Bike Trip, Casual using Docked vs Member, echo=FALSE}
# Now let's show it side by side with Members
year_2022_q2_dockedcasualvsmember <- data.frame (member_casual = rep(c("casual","member"),each=7),
                                     day_of_week_num = c(year_2022_q2_casual_docked_bike_df$day_of_week_num,year_2022_qAll_member_df$day_of_week_num),
                                     Q2 = c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2),
                                     Q2seconds = hour(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2))*60*60+minute(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2))*60+second(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2)),
                                     Q2Text = createTimeStampWHH(c(hour(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2))),
                                                                 c(minute(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2))),
                                                                 c(second(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2)))
                                     )
)



ggplot(data=year_2022_q2_dockedcasualvsmember,aes(x=day_of_week_num,y=Q2seconds, fill=member_casual))+
  geom_bar(stat = "identity",width=.86,position=position_dodge(width=.9)) +
  labs(title = "Year 2022 Q2 Bike Trip, Casual using Docked vs Member",
       subtitle = "The second quantile of casual rider's length of time using docked bikes vs member's",
       x="Day of the Week",
       y="Length of Trip (HH:MM:SS)")+
  geom_text(aes(label = Q2Text ),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.5,angle=0) +
  scale_y_time(limits = as.hms(c('00:00:00', '01:10:00')))+
  scale_x_continuous(
    breaks = seq_along(days_of_the_week), 
    labels = days_of_the_week
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  ) +
  scale_fill_manual(values = c("red","violet"),name="Customer")


```

With these three analyses, recommendations can be made. [Jump to Recommendations](#ptE)

[Jump to Top](#toc)<br/>

## <a name="ptD" />D. Additional Supporting Visualizations
### <a name="#MoreViz1" /> [Jump to the report location the following is referenced](#VizRef1)

```{r Year 2022 Bike Popularity Casual Three,figures-side , fig.show="hold", echo=FALSE}
graph_year2022casual_numOfBike_month_classic
graph_year2022casual_numOfBike_month_docked
graph_year2022casual_numOfBike_month_electric
```

### <a name="#MoreViz2" /> [Jump to the report location the following is referenced](#VizRef2)

```{r Year 2022 Bike Popularity Member Three, figures-side, fig.show="hold", echo=FALSE}
graph_year2022member_numOfBike_month_classic
graph_year2022member_numOfBike_month_docked
graph_year2022member_numOfBike_month_electric
```

[Jump to Top](#toc)<br/>

## <a name="ptE" />E. Recommendations

After completion of the analysis, here are my three recommendations:

1. **Create summer promotions to help convert casual customers to members.**
* Casual customers use bikes more frequently in the summer months. 
2. **Create promotions advertising electric-powered bikes. Increase number of electric bikes available.**
* Casual customers use more electric bikes over classic bikes. 
3. **Advertising should include member testimonials about how much time is saved by not having to use the docked bikes.**
* Casual customers take longer trips through the service comparatively to current members, especially when it comes to docked bikes. 
* Current members also do not use docked bikes. 

## <a name="ptF" />F. Appendix

### Bulky Code:
This section contains code mentioned in the report. Code here will not evaluate.

#### <a name="Appx1"/>F.1 Anaylsis Functions
[Jump to report location this is used](#Ref1)
```{r APPX: Analysis Functions, include=TRUE, eval=FALSE}

# Function - Filters member status and day of the week
filter_mc_dow = function(input_cleandata,input_MC,input_dow){
  return <- subset(select(input_cleandata, ride_id,rideable_type,length_of_trip,day_of_week,member_casual,length_of_trip_r),
                   member_casual==input_MC & day_of_week==input_dow)
}

# Function - Handle Quantile data
## Get all Quantile data and put it into a dataframe
create_df_q_data <- function(input_cleandata,input_MC){
  
  # Get quantile for each day
  tmp_quantile_1 <- quantile(filter_mc_dow(input_cleandata,input_MC,1)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_2 <- quantile(filter_mc_dow(input_cleandata,input_MC,2)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_3 <- quantile(filter_mc_dow(input_cleandata,input_MC,3)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_4 <- quantile(filter_mc_dow(input_cleandata,input_MC,4)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_5 <- quantile(filter_mc_dow(input_cleandata,input_MC,5)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_6 <- quantile(filter_mc_dow(input_cleandata,input_MC,6)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_7 <- quantile(filter_mc_dow(input_cleandata,input_MC,7)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  
  return <- data.frame(day_of_week = c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat"),
                       day_of_week_num = c(1:7),
                       Q1 = c(
                         tmp_quantile_1[2],
                         tmp_quantile_2[2],
                         tmp_quantile_3[2],
                         tmp_quantile_4[2],
                         tmp_quantile_5[2],
                         tmp_quantile_6[2],
                         tmp_quantile_7[2]
                       ),
                       Q2 = c(
                         tmp_quantile_1[3],
                         tmp_quantile_2[3],
                         tmp_quantile_3[3],
                         tmp_quantile_4[3],
                         tmp_quantile_5[3],
                         tmp_quantile_6[3],
                         tmp_quantile_7[3]
                       ),
                       Q3 = c(
                         tmp_quantile_1[4],
                         tmp_quantile_2[4],
                         tmp_quantile_3[4],
                         tmp_quantile_4[4],
                         tmp_quantile_5[4],
                         tmp_quantile_6[4],
                         tmp_quantile_7[4]
                       ),
                       Q4 = c(
                         tmp_quantile_1[5],
                         tmp_quantile_2[5],
                         tmp_quantile_3[5],
                         tmp_quantile_4[5],
                         tmp_quantile_5[5],
                         tmp_quantile_6[5],
                         tmp_quantile_7[5]
                       )
                       )
}

# Function - Create table of number of trips
create_df_num_of_trips <- function(input_cleandata,input_MorC){
  return <- data.frame(day_of_week = c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat"),
                       num_of_trips = c(nrow(filter_mc_dow(input_cleandata,input_MorC,1)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,2)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,3)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,4)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,5)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,6)),
                                        nrow(filter_mc_dow(input_cleandata,input_MorC,7))
                       )
  )
}
# Function - Create a table of number of trips that less than Q2
create_df_num_of_trips_q <- function(input_cleandata,input_MorC,input_q){
  
  
  tmp_filter_data_MorC1 <-filter_mc_dow(input_cleandata,input_MorC,1)
  tmp_filter_data_MorC2 <-filter_mc_dow(input_cleandata,input_MorC,2)
  tmp_filter_data_MorC3 <-filter_mc_dow(input_cleandata,input_MorC,3)
  tmp_filter_data_MorC4 <-filter_mc_dow(input_cleandata,input_MorC,4)
  tmp_filter_data_MorC5 <-filter_mc_dow(input_cleandata,input_MorC,5)
  tmp_filter_data_MorC6 <-filter_mc_dow(input_cleandata,input_MorC,6)
  tmp_filter_data_MorC7 <-filter_mc_dow(input_cleandata,input_MorC,7)
  
  # Get quantile for each day
  tmp_quantile_1 <- quantile(filter_mc_dow(input_cleandata,input_MorC,1)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_2 <- quantile(filter_mc_dow(input_cleandata,input_MorC,2)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_3 <- quantile(filter_mc_dow(input_cleandata,input_MorC,3)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_4 <- quantile(filter_mc_dow(input_cleandata,input_MorC,4)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_5 <- quantile(filter_mc_dow(input_cleandata,input_MorC,5)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_6 <- quantile(filter_mc_dow(input_cleandata,input_MorC,6)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  tmp_quantile_7 <- quantile(filter_mc_dow(input_cleandata,input_MorC,7)$length_of_trip_r,probs = c(0,0.25,0.5,0.75,1)) 
  
  
  return <- data.frame(day_of_week = c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat"),
                       num_of_trips = c(sum(tmp_filter_data_MorC1$length_of_trip_r <= tmp_quantile_1[input_q]),
                                        sum(tmp_filter_data_MorC2$length_of_trip_r <= tmp_quantile_2[input_q]),
                                        sum(tmp_filter_data_MorC3$length_of_trip_r <= tmp_quantile_3[input_q]),
                                        sum(tmp_filter_data_MorC4$length_of_trip_r <= tmp_quantile_4[input_q]),
                                        sum(tmp_filter_data_MorC5$length_of_trip_r <= tmp_quantile_5[input_q]),
                                        sum(tmp_filter_data_MorC6$length_of_trip_r <= tmp_quantile_6[input_q]),
                                        sum(tmp_filter_data_MorC7$length_of_trip_r <= tmp_quantile_7[input_q])
                                        )
                      )
}

# Function - Find Num of Bikes Used per day per type of user
## Writing a function to make finding bike values cleaner
find_bike_data <- function(input_clean_data_rideable_type,input_clean_data_member_casual,memberOrCasual,input_clean_data_day_of_week){
  return <- data.frame(day_of_week = c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat"),
                       classic_bike = c(sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 1),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 2),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 3),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 4),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 5),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 6),
                                        sum(input_clean_data_rideable_type == "classic_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 7)
                                        ),
                       docked_bike = c(sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 1),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 2),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 3),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 4),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 5),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 6),
                                       sum(input_clean_data_rideable_type == "docked_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 7)
                                       ),
                       electric_bike = c(sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 1),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 2),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 3),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 4),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 5),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 6),
                                         sum(input_clean_data_rideable_type == "electric_bike" & input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 7)
                                       ),
                       total = c(sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 1),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 2),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 3),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 4),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 5),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 6),
                                      sum(input_clean_data_member_casual==memberOrCasual& input_clean_data_day_of_week == 7)
                                      )
  )
}
```

#### <a name="Appx2"/>F.2 Applying Functions to Clean Data
[Jump to report location this is used](#Ref2)
```{r APPX: Applying Functions to Clean Data, include=TRUE, eval=FALSE}
# JANUARY
jan_2022_casual_df <- create_df_num_of_trips(jan_2022_clean,"casual")
jan_2022_member_df <- create_df_num_of_trips(jan_2022_clean,"member")
jan_2022_qAll_casual_df <- create_df_q_data(jan_2022_clean,"casual")
jan_2022_qAll_member_df <- create_df_q_data(jan_2022_clean,"member")
jan_2022_q2_casual_df <- create_df_num_of_trips_q(jan_2022_clean,"casual",3)
jan_2022_q2_member_df <- create_df_num_of_trips_q(jan_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
jan_2022_bike_type_Casual_df <- find_bike_data(jan_2022_clean$rideable_type,jan_2022_clean$member_casual,"casual",jan_2022_clean$day_of_week)
jan_2022_bike_type_Member_df <- find_bike_data(jan_2022_clean$rideable_type,jan_2022_clean$member_casual,"member",jan_2022_clean$day_of_week)

# FEBRUARY
feb_2022_casual_df <- create_df_num_of_trips(feb_2022_clean,"casual")
feb_2022_member_df <- create_df_num_of_trips(feb_2022_clean,"member")
feb_2022_qAll_casual_df <- create_df_q_data(feb_2022_clean,"casual")
feb_2022_qAll_member_df <- create_df_q_data(feb_2022_clean,"member")
feb_2022_q2_casual_df <- create_df_num_of_trips_q(feb_2022_clean,"casual",3)
feb_2022_q2_member_df <- create_df_num_of_trips_q(feb_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
feb_2022_bike_type_Casual_df <- find_bike_data(feb_2022_clean$rideable_type,feb_2022_clean$member_casual,"casual",feb_2022_clean$day_of_week)
feb_2022_bike_type_Member_df <- find_bike_data(feb_2022_clean$rideable_type,feb_2022_clean$member_casual,"member",feb_2022_clean$day_of_week)


# MARCH
mar_2022_casual_df <- create_df_num_of_trips(mar_2022_clean,"casual")
mar_2022_member_df <- create_df_num_of_trips(mar_2022_clean,"member")
mar_2022_qAll_casual_df <- create_df_q_data(mar_2022_clean,"casual")
mar_2022_qAll_member_df <- create_df_q_data(mar_2022_clean,"member")
mar_2022_q2_casual_df <- create_df_num_of_trips_q(mar_2022_clean,"casual",3)
mar_2022_q2_member_df <- create_df_num_of_trips_q(mar_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
mar_2022_bike_type_Casual_df <- find_bike_data(mar_2022_clean$rideable_type,mar_2022_clean$member_casual,"casual",mar_2022_clean$day_of_week)
mar_2022_bike_type_Member_df <- find_bike_data(mar_2022_clean$rideable_type,mar_2022_clean$member_casual,"member",mar_2022_clean$day_of_week)

# APRIL
apr_2022_casual_df <- create_df_num_of_trips(apr_2022_clean,"casual")
apr_2022_member_df <- create_df_num_of_trips(apr_2022_clean,"member")
apr_2022_qAll_casual_df <- create_df_q_data(apr_2022_clean,"casual")
apr_2022_qAll_member_df <- create_df_q_data(apr_2022_clean,"member")
apr_2022_q2_casual_df <- create_df_num_of_trips_q(apr_2022_clean,"casual",3)
apr_2022_q2_member_df <- create_df_num_of_trips_q(apr_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
apr_2022_bike_type_Casual_df <- find_bike_data(apr_2022_clean$rideable_type,apr_2022_clean$member_casual,"casual",apr_2022_clean$day_of_week)
apr_2022_bike_type_Member_df <- find_bike_data(apr_2022_clean$rideable_type,apr_2022_clean$member_casual,"member",apr_2022_clean$day_of_week)


# MAY
may_2022_casual_df <- create_df_num_of_trips(may_2022_clean,"casual")
may_2022_member_df <- create_df_num_of_trips(may_2022_clean,"member")
may_2022_qAll_casual_df <- create_df_q_data(may_2022_clean,"casual")
may_2022_qAll_member_df <- create_df_q_data(may_2022_clean,"member")
may_2022_q2_casual_df <- create_df_num_of_trips_q(may_2022_clean,"casual",3)
may_2022_q2_member_df <- create_df_num_of_trips_q(may_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
may_2022_bike_type_Casual_df <- find_bike_data(may_2022_clean$rideable_type,may_2022_clean$member_casual,"casual",may_2022_clean$day_of_week)
may_2022_bike_type_Member_df <- find_bike_data(may_2022_clean$rideable_type,may_2022_clean$member_casual,"member",may_2022_clean$day_of_week)


# JUNE
jun_2022_casual_df <- create_df_num_of_trips(jun_2022_clean,"casual")
jun_2022_member_df <- create_df_num_of_trips(jun_2022_clean,"member")
jun_2022_qAll_casual_df <- create_df_q_data(jun_2022_clean,"casual")
jun_2022_qAll_member_df <- create_df_q_data(jun_2022_clean,"member")
jun_2022_q2_casual_df <- create_df_num_of_trips_q(jun_2022_clean,"casual",3)
jun_2022_q2_member_df <- create_df_num_of_trips_q(jun_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
jun_2022_bike_type_Casual_df <- find_bike_data(jun_2022_clean$rideable_type,jun_2022_clean$member_casual,"casual",jun_2022_clean$day_of_week)
jun_2022_bike_type_Member_df <- find_bike_data(jun_2022_clean$rideable_type,jun_2022_clean$member_casual,"member",jun_2022_clean$day_of_week)


# JULY
jul_2022_casual_df <- create_df_num_of_trips(jul_2022_clean,"casual")
jul_2022_member_df <- create_df_num_of_trips(jul_2022_clean,"member")
jul_2022_qAll_casual_df <- create_df_q_data(jul_2022_clean,"casual")
jul_2022_qAll_member_df <- create_df_q_data(jul_2022_clean,"member")
jul_2022_q2_casual_df <- create_df_num_of_trips_q(jul_2022_clean,"casual",3)
jul_2022_q2_member_df <- create_df_num_of_trips_q(jul_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
jul_2022_bike_type_Casual_df <- find_bike_data(jul_2022_clean$rideable_type,jul_2022_clean$member_casual,"casual",jul_2022_clean$day_of_week)
jul_2022_bike_type_Member_df <- find_bike_data(jul_2022_clean$rideable_type,jul_2022_clean$member_casual,"member",jul_2022_clean$day_of_week)


# AUGUST
aug_2022_casual_df <- create_df_num_of_trips(aug_2022_clean,"casual")
aug_2022_member_df <- create_df_num_of_trips(aug_2022_clean,"member")
aug_2022_qAll_casual_df <- create_df_q_data(aug_2022_clean,"casual")
aug_2022_qAll_member_df <- create_df_q_data(aug_2022_clean,"member")
aug_2022_q2_casual_df <- create_df_num_of_trips_q(aug_2022_clean,"casual",3)
aug_2022_q2_member_df <- create_df_num_of_trips_q(aug_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
aug_2022_bike_type_Casual_df <- find_bike_data(aug_2022_clean$rideable_type,aug_2022_clean$member_casual,"casual",aug_2022_clean$day_of_week)
aug_2022_bike_type_Member_df <- find_bike_data(aug_2022_clean$rideable_type,aug_2022_clean$member_casual,"member",aug_2022_clean$day_of_week)


# SEPTEMBER
sep_2022_casual_df <- create_df_num_of_trips(sep_2022_clean,"casual")
sep_2022_member_df <- create_df_num_of_trips(sep_2022_clean,"member")
sep_2022_qAll_casual_df <- create_df_q_data(sep_2022_clean,"casual")
sep_2022_qAll_member_df <- create_df_q_data(sep_2022_clean,"member")
sep_2022_q2_casual_df <- create_df_num_of_trips_q(sep_2022_clean,"casual",3)
sep_2022_q2_member_df <- create_df_num_of_trips_q(sep_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
sep_2022_bike_type_Casual_df <- find_bike_data(sep_2022_clean$rideable_type,sep_2022_clean$member_casual,"casual",sep_2022_clean$day_of_week)
sep_2022_bike_type_Member_df <- find_bike_data(sep_2022_clean$rideable_type,sep_2022_clean$member_casual,"member",sep_2022_clean$day_of_week)


# OCTOBER
oct_2022_casual_df <- create_df_num_of_trips(oct_2022_clean,"casual")
oct_2022_member_df <- create_df_num_of_trips(oct_2022_clean,"member")
oct_2022_qAll_casual_df <- create_df_q_data(oct_2022_clean,"casual")
oct_2022_qAll_member_df <- create_df_q_data(oct_2022_clean,"member")
oct_2022_q2_casual_df <- create_df_num_of_trips_q(oct_2022_clean,"casual",3)
oct_2022_q2_member_df <- create_df_num_of_trips_q(oct_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
oct_2022_bike_type_Casual_df <- find_bike_data(oct_2022_clean$rideable_type,oct_2022_clean$member_casual,"casual",oct_2022_clean$day_of_week)
oct_2022_bike_type_Member_df <- find_bike_data(oct_2022_clean$rideable_type,oct_2022_clean$member_casual,"member",oct_2022_clean$day_of_week)

# NOVEMBER
nov_2022_casual_df <- create_df_num_of_trips(nov_2022_clean,"casual")
nov_2022_member_df <- create_df_num_of_trips(nov_2022_clean,"member")
nov_2022_qAll_casual_df <- create_df_q_data(nov_2022_clean,"casual")
nov_2022_qAll_member_df <- create_df_q_data(nov_2022_clean,"member")
nov_2022_q2_casual_df <- create_df_num_of_trips_q(nov_2022_clean,"casual",3)
nov_2022_q2_member_df <- create_df_num_of_trips_q(nov_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
nov_2022_bike_type_Casual_df <- find_bike_data(nov_2022_clean$rideable_type,nov_2022_clean$member_casual,"casual",nov_2022_clean$day_of_week)
nov_2022_bike_type_Member_df <- find_bike_data(nov_2022_clean$rideable_type,nov_2022_clean$member_casual,"member",nov_2022_clean$day_of_week)

# DECEMBER
dec_2022_casual_df <- create_df_num_of_trips(dec_2022_clean,"casual")
dec_2022_member_df <- create_df_num_of_trips(dec_2022_clean,"member")
dec_2022_qAll_casual_df <- create_df_q_data(dec_2022_clean,"casual")
dec_2022_qAll_member_df <- create_df_q_data(dec_2022_clean,"member")
dec_2022_q2_casual_df <- create_df_num_of_trips_q(dec_2022_clean,"casual",3)
dec_2022_q2_member_df <- create_df_num_of_trips_q(dec_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
dec_2022_bike_type_Casual_df <- find_bike_data(dec_2022_clean$rideable_type,dec_2022_clean$member_casual,"casual",dec_2022_clean$day_of_week)
dec_2022_bike_type_Member_df <- find_bike_data(dec_2022_clean$rideable_type,dec_2022_clean$member_casual,"member",dec_2022_clean$day_of_week)

# 2022
year_2022_clean <- rbind(jan_2022_clean, feb_2022_clean, mar_2022_clean, apr_2022_clean, 
                         may_2022_clean, jun_2022_clean, jul_2022_clean, aug_2022_clean, 
                         sep_2022_clean, oct_2022_clean, nov_2022_clean, dec_2022_clean)
year_2022_casual_df <- create_df_num_of_trips(year_2022_clean,"casual")
year_2022_member_df <- create_df_num_of_trips(year_2022_clean,"member")
year_2022_qAll_casual_df <- create_df_q_data(year_2022_clean,"casual")
year_2022_qAll_member_df <- create_df_q_data(year_2022_clean,"member")
year_2022_q2_casual_df <- create_df_num_of_trips_q(year_2022_clean,"casual",3)
year_2022_q2_member_df <- create_df_num_of_trips_q(year_2022_clean,"member",3)
# Determining Most Popular Type of Bike
# classic_bike, docked_bike, electric_bike
year_2022_bike_type_Casual_df <- find_bike_data(year_2022_clean$rideable_type,year_2022_clean$member_casual,"casual",year_2022_clean$day_of_week)
year_2022_bike_type_Member_df <- find_bike_data(year_2022_clean$rideable_type,year_2022_clean$member_casual,"member",year_2022_clean$day_of_week)
```

#### <a name="Appx3"/>F.3 Year 2022 Customer Trip Frequency
[Jump to report location this is used](#Ref3)
```{r APPX: Year 2022 Customers Trip Frequency, include=TRUE, eval=FALSE}
df_customer_numOfTrip_vMonth <- data.frame(customer_type = rep(c("casual","member"),each=12),
                                           monthNum = rep(as.factor(c(1:12)),2),
                                           num_of_trips = c(sum(jan_2022_casual_df$num_of_trips),
                                             sum(feb_2022_casual_df$num_of_trips),
                                             sum(mar_2022_casual_df$num_of_trips),
                                             sum(apr_2022_casual_df$num_of_trips),
                                             sum(may_2022_casual_df$num_of_trips),
                                             sum(jun_2022_casual_df$num_of_trips),
                                             sum(jul_2022_casual_df$num_of_trips),
                                             sum(aug_2022_casual_df$num_of_trips),
                                             sum(sep_2022_casual_df$num_of_trips),
                                             sum(oct_2022_casual_df$num_of_trips),
                                             sum(nov_2022_casual_df$num_of_trips),
                                             sum(dec_2022_casual_df$num_of_trips),
                                             sum(jan_2022_member_df$num_of_trips),
                                             sum(feb_2022_member_df$num_of_trips),
                                             sum(mar_2022_member_df$num_of_trips),
                                             sum(apr_2022_member_df$num_of_trips),
                                             sum(may_2022_member_df$num_of_trips),
                                             sum(jun_2022_member_df$num_of_trips),
                                             sum(jul_2022_member_df$num_of_trips),
                                             sum(aug_2022_member_df$num_of_trips),
                                             sum(sep_2022_member_df$num_of_trips),
                                             sum(oct_2022_member_df$num_of_trips),
                                             sum(nov_2022_member_df$num_of_trips),
                                             sum(dec_2022_member_df$num_of_trips)
                                             )
                                          )

graph_year2022_tripfreq_customer <- ggplot(data=df_customer_numOfTrip_vMonth,aes(x=monthNum,y=num_of_trips, fill = customer_type)) +
  geom_bar(stat = "identity",width=.86,position=position_dodge(width=.9))+
  labs(title = "Year 2022 Customers' Trip Frequency",
       subtitle = "Number of Trips per month",
       x="Per Month",
       y="Number of Trips (K*)",
       caption="K stands for 1000") +
  scale_fill_discrete(name="Customer") +
  geom_text(aes(label = paste(c(floor(num_of_trips/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=2.75,hjust= 1,vjust=-.75,angle=-60) +
  scale_y_continuous(limits = c(0,500000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_discrete(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )
```

#### <a name="Appx4"/>F.4 Year 2022 Bike Preferences, Casual and Member
[Jump to report location this is used](#Ref4)
```{r APPX: Year 2022 Bike Preferences, include=TRUE, eval=FALSE}

yearByMonth_2022_bike_type_Casual_df <- data.frame(
  month = c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
  monthNum = c(1:12),
  classic_bike = c(
    sum(jan_2022_bike_type_Casual_df$classic_bike),
    sum(feb_2022_bike_type_Casual_df$classic_bike),
    sum(mar_2022_bike_type_Casual_df$classic_bike),
    sum(apr_2022_bike_type_Casual_df$classic_bike),
    sum(may_2022_bike_type_Casual_df$classic_bike),
    sum(jun_2022_bike_type_Casual_df$classic_bike),
    sum(jul_2022_bike_type_Casual_df$classic_bike),
    sum(aug_2022_bike_type_Casual_df$classic_bike),
    sum(sep_2022_bike_type_Casual_df$classic_bike),
    sum(oct_2022_bike_type_Casual_df$classic_bike),
    sum(nov_2022_bike_type_Casual_df$classic_bike),
    sum(dec_2022_bike_type_Casual_df$classic_bike)
  ) ,
  docked_bike = c(
    sum(jan_2022_bike_type_Casual_df$docked_bike),
    sum(feb_2022_bike_type_Casual_df$docked_bike),
    sum(mar_2022_bike_type_Casual_df$docked_bike),
    sum(apr_2022_bike_type_Casual_df$docked_bike),
    sum(may_2022_bike_type_Casual_df$docked_bike),
    sum(jun_2022_bike_type_Casual_df$docked_bike),
    sum(jul_2022_bike_type_Casual_df$docked_bike),
    sum(aug_2022_bike_type_Casual_df$docked_bike),
    sum(sep_2022_bike_type_Casual_df$docked_bike),
    sum(oct_2022_bike_type_Casual_df$docked_bike),
    sum(nov_2022_bike_type_Casual_df$docked_bike),
    sum(dec_2022_bike_type_Casual_df$docked_bike)
  ) ,
  electric_bike = c(
    sum(jan_2022_bike_type_Casual_df$electric_bike),
    sum(feb_2022_bike_type_Casual_df$electric_bike),
    sum(mar_2022_bike_type_Casual_df$electric_bike),
    sum(apr_2022_bike_type_Casual_df$electric_bike),
    sum(may_2022_bike_type_Casual_df$electric_bike),
    sum(jun_2022_bike_type_Casual_df$electric_bike),
    sum(jul_2022_bike_type_Casual_df$electric_bike),
    sum(aug_2022_bike_type_Casual_df$electric_bike),
    sum(sep_2022_bike_type_Casual_df$electric_bike),
    sum(oct_2022_bike_type_Casual_df$electric_bike),
    sum(nov_2022_bike_type_Casual_df$electric_bike),
    sum(dec_2022_bike_type_Casual_df$electric_bike)
  ),
  total = c( 
    sum(jan_2022_bike_type_Casual_df$classic_bike) + sum(jan_2022_bike_type_Casual_df$docked_bike) + sum(jan_2022_bike_type_Casual_df$electric_bike),
    sum(feb_2022_bike_type_Casual_df$classic_bike) + sum(feb_2022_bike_type_Casual_df$docked_bike) + sum(feb_2022_bike_type_Casual_df$electric_bike),
    sum(mar_2022_bike_type_Casual_df$classic_bike) + sum(mar_2022_bike_type_Casual_df$docked_bike) + sum(mar_2022_bike_type_Casual_df$electric_bike),
    sum(apr_2022_bike_type_Casual_df$classic_bike) + sum(apr_2022_bike_type_Casual_df$docked_bike) + sum(apr_2022_bike_type_Casual_df$electric_bike),
    sum(may_2022_bike_type_Casual_df$classic_bike) + sum(may_2022_bike_type_Casual_df$docked_bike) + sum(may_2022_bike_type_Casual_df$electric_bike),
    sum(jun_2022_bike_type_Casual_df$classic_bike) + sum(jun_2022_bike_type_Casual_df$docked_bike) + sum(jun_2022_bike_type_Casual_df$electric_bike),
    sum(jul_2022_bike_type_Casual_df$classic_bike) + sum(jul_2022_bike_type_Casual_df$docked_bike) + sum(jul_2022_bike_type_Casual_df$electric_bike),
    sum(aug_2022_bike_type_Casual_df$classic_bike) + sum(aug_2022_bike_type_Casual_df$docked_bike) + sum(aug_2022_bike_type_Casual_df$electric_bike),
    sum(sep_2022_bike_type_Casual_df$classic_bike) + sum(sep_2022_bike_type_Casual_df$docked_bike) + sum(sep_2022_bike_type_Casual_df$electric_bike),
    sum(oct_2022_bike_type_Casual_df$classic_bike) + sum(oct_2022_bike_type_Casual_df$docked_bike) + sum(oct_2022_bike_type_Casual_df$electric_bike),
    sum(nov_2022_bike_type_Casual_df$classic_bike) + sum(nov_2022_bike_type_Casual_df$docked_bike) + sum(nov_2022_bike_type_Casual_df$electric_bike),
    sum(dec_2022_bike_type_Casual_df$classic_bike) + sum(dec_2022_bike_type_Casual_df$docked_bike) + sum(dec_2022_bike_type_Casual_df$electric_bike)
  )
)

yearByMonth_2022_bike_type_Member_df <- data.frame(
  month = c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
  monthNum = c(1:12),
  classic_bike = c(
    sum(jan_2022_bike_type_Member_df$classic_bike),
    sum(feb_2022_bike_type_Member_df$classic_bike),
    sum(mar_2022_bike_type_Member_df$classic_bike),
    sum(apr_2022_bike_type_Member_df$classic_bike),
    sum(may_2022_bike_type_Member_df$classic_bike),
    sum(jun_2022_bike_type_Member_df$classic_bike),
    sum(jul_2022_bike_type_Member_df$classic_bike),
    sum(aug_2022_bike_type_Member_df$classic_bike),
    sum(sep_2022_bike_type_Member_df$classic_bike),
    sum(oct_2022_bike_type_Member_df$classic_bike),
    sum(nov_2022_bike_type_Member_df$classic_bike),
    sum(dec_2022_bike_type_Member_df$classic_bike)
  ) ,
  docked_bike = c(
    sum(jan_2022_bike_type_Member_df$docked_bike),
    sum(feb_2022_bike_type_Member_df$docked_bike),
    sum(mar_2022_bike_type_Member_df$docked_bike),
    sum(apr_2022_bike_type_Member_df$docked_bike),
    sum(may_2022_bike_type_Member_df$docked_bike),
    sum(jun_2022_bike_type_Member_df$docked_bike),
    sum(jul_2022_bike_type_Member_df$docked_bike),
    sum(aug_2022_bike_type_Member_df$docked_bike),
    sum(sep_2022_bike_type_Member_df$docked_bike),
    sum(oct_2022_bike_type_Member_df$docked_bike),
    sum(nov_2022_bike_type_Member_df$docked_bike),
    sum(dec_2022_bike_type_Member_df$docked_bike)
  ) ,
  electric_bike = c(
    sum(jan_2022_bike_type_Member_df$electric_bike),
    sum(feb_2022_bike_type_Member_df$electric_bike),
    sum(mar_2022_bike_type_Member_df$electric_bike),
    sum(apr_2022_bike_type_Member_df$electric_bike),
    sum(may_2022_bike_type_Member_df$electric_bike),
    sum(jun_2022_bike_type_Member_df$electric_bike),
    sum(jul_2022_bike_type_Member_df$electric_bike),
    sum(aug_2022_bike_type_Member_df$electric_bike),
    sum(sep_2022_bike_type_Member_df$electric_bike),
    sum(oct_2022_bike_type_Member_df$electric_bike),
    sum(nov_2022_bike_type_Member_df$electric_bike),
    sum(dec_2022_bike_type_Member_df$electric_bike)
  ),
  total = c( 
    sum(jan_2022_bike_type_Member_df$classic_bike) + sum(jan_2022_bike_type_Member_df$docked_bike) + sum(jan_2022_bike_type_Member_df$electric_bike),
    sum(feb_2022_bike_type_Member_df$classic_bike) + sum(feb_2022_bike_type_Member_df$docked_bike) + sum(feb_2022_bike_type_Member_df$electric_bike),
    sum(mar_2022_bike_type_Member_df$classic_bike) + sum(mar_2022_bike_type_Member_df$docked_bike) + sum(mar_2022_bike_type_Member_df$electric_bike),
    sum(apr_2022_bike_type_Member_df$classic_bike) + sum(apr_2022_bike_type_Member_df$docked_bike) + sum(apr_2022_bike_type_Member_df$electric_bike),
    sum(may_2022_bike_type_Member_df$classic_bike) + sum(may_2022_bike_type_Member_df$docked_bike) + sum(may_2022_bike_type_Member_df$electric_bike),
    sum(jun_2022_bike_type_Member_df$classic_bike) + sum(jun_2022_bike_type_Member_df$docked_bike) + sum(jun_2022_bike_type_Member_df$electric_bike),
    sum(jul_2022_bike_type_Member_df$classic_bike) + sum(jul_2022_bike_type_Member_df$docked_bike) + sum(jul_2022_bike_type_Member_df$electric_bike),
    sum(aug_2022_bike_type_Member_df$classic_bike) + sum(aug_2022_bike_type_Member_df$docked_bike) + sum(aug_2022_bike_type_Member_df$electric_bike),
    sum(sep_2022_bike_type_Member_df$classic_bike) + sum(sep_2022_bike_type_Member_df$docked_bike) + sum(sep_2022_bike_type_Member_df$electric_bike),
    sum(oct_2022_bike_type_Member_df$classic_bike) + sum(oct_2022_bike_type_Member_df$docked_bike) + sum(oct_2022_bike_type_Member_df$electric_bike),
    sum(nov_2022_bike_type_Member_df$classic_bike) + sum(nov_2022_bike_type_Member_df$docked_bike) + sum(nov_2022_bike_type_Member_df$electric_bike),
    sum(dec_2022_bike_type_Member_df$classic_bike) + sum(dec_2022_bike_type_Member_df$docked_bike) + sum(dec_2022_bike_type_Member_df$electric_bike)
  )
)

# Adjust Table for Bar Plot
yearByMonth_2022_bike_type_Casual_subgrouped_df <-data.frame(biketype = rep(c("classic","docked","electric"),each=12),
                                                             monthNum = rep(yearByMonth_2022_bike_type_Casual_df$monthNum,3),
                                                             num_of_bike = c(yearByMonth_2022_bike_type_Casual_df$classic_bike,
                                                                             yearByMonth_2022_bike_type_Casual_df$docked_bike,
                                                                             yearByMonth_2022_bike_type_Casual_df$electric_bike)
                                                             )

yearByMonth_2022_bike_type_Member_subgrouped_df <-data.frame(biketype = rep(c("classic","docked","electric"),each=12),
                                                             monthNum = rep(yearByMonth_2022_bike_type_Member_df$monthNum,3),
                                                             num_of_bike = c(yearByMonth_2022_bike_type_Member_df$classic_bike,
                                                                             yearByMonth_2022_bike_type_Member_df$docked_bike,
                                                                             yearByMonth_2022_bike_type_Member_df$electric_bike)
)

# Get Year By Month but remove docked
yearByMonth_2022_bike_type_Casual_subgrouped_sansDocked_df <-data.frame(biketype = rep(c("classic","electric"),each=12),
                                                             monthNum = rep(yearByMonth_2022_bike_type_Casual_df$monthNum,2),
                                                             num_of_bike = c(yearByMonth_2022_bike_type_Casual_df$classic_bike,
                                                                             yearByMonth_2022_bike_type_Casual_df$electric_bike)
)

# Get Year By Month but remove docked
yearByMonth_2022_bike_type_Member_subgrouped_sansDocked_df <-data.frame(biketype = rep(c("classic","electric"),each=12),
                                                                        monthNum = rep(yearByMonth_2022_bike_type_Member_df$monthNum,2),
                                                                        num_of_bike = c(yearByMonth_2022_bike_type_Member_df$classic_bike,
                                                                                        yearByMonth_2022_bike_type_Member_df$electric_bike)
)



```

```{r APPX: Year 2022 Bike Preferences Casual Plots, include=TRUE, eval=FALSE}
# Used to label plots
days_of_the_week <- c("Sunday", "Monday", "Tuesday", "Wednesday", 
                      "Thursday", "Friday", "Saturday")

# Year 2022 Bike Popularity for Casual Customers
graph_year2022casual_numOfBike_month_biketype <- ggplot(data=yearByMonth_2022_bike_type_Casual_subgrouped_df,aes(x=monthNum,y=num_of_bike, fill = biketype)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1))+
  labs(title = "Year 2022 Bike Popularity, Casual",
       subtitle = "Amount of each bike used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption = "*K stands for 1000") +
  #geom_text(aes(label = signif(num_of_bike)), nudge_y = 3) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )

# Year 2022 Bike Popularity for Casual Customers - Sans Docked
graph_year2022casual_numOfBike_month_biketype_sansDocked <- ggplot(data=yearByMonth_2022_bike_type_Casual_subgrouped_sansDocked_df,aes(x=monthNum,y=num_of_bike, fill = biketype)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1))+
  labs(title = "Year 2022 Bike Popularity, Casual**",
       subtitle = "Amount of either classic or electic bike used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption = "**This graph does not feature docked bikes, *K stands for 1000") +
  #geom_text(aes(label = signif(num_of_bike)), nudge_y = 3) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )+
  scale_fill_manual(values = c("#F8766D","#619CFF"))

# Individual
graph_year2022casual_numOfBike_month_classic <- ggplot(data=yearByMonth_2022_bike_type_Casual_df, aes(x=monthNum,y=classic_bike)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1), fill = "#F8766D")+
  labs(title = "Year 2022 Bike Popularity, Casual - Classic",
       subtitle = "Amount of classic bikes used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(classic_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 

graph_year2022casual_numOfBike_month_docked <- ggplot(data=yearByMonth_2022_bike_type_Casual_df, aes(x=monthNum,y=docked_bike)) +
  geom_bar(stat = "identity",width=0.9,position=position_dodge(width=1), fill="#00BA38")+
  labs(title = "Year 2022 Bike Popularity, Casual - Docked",
       subtitle = "Amount of docked bikes used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(docked_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 


graph_year2022casual_numOfBike_month_electric <- ggplot(data=yearByMonth_2022_bike_type_Casual_df, aes(x=monthNum,y=electric_bike)) +
  geom_bar(stat = "identity",width=0.9,position=position_dodge(width=1), fill="#619CFF")+
  labs(title = "Year 2022 Bike Popularity, Casual - Electric",
       subtitle = "Amount of electric bikes used by Casual Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(electric_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 
```

```{r APPX: Year 2022 Bike Popularity Casual, include=TRUE, eval=FALSE}
graph_year2022casual_numOfBike_month_biketype_sansDocked
graph_year2022casual_numOfBike_month_biketype
```

```{r APPX: Year 2022 Bike Preferences Member Plots, include=TRUE, eval=FALSE}
# Year 2022 Bike Popularity for Member Customers
graph_year2022member_numOfBike_month_biketype <- ggplot(data=yearByMonth_2022_bike_type_Member_subgrouped_df,aes(x=monthNum,y=num_of_bike, fill = biketype)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1))+
  labs(title = "Year 2022 Bike Popularity, Member",
       subtitle = "Amount of each bike used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption = "*K stands for 1000") +
  #geom_text(aes(label = signif(num_of_bike)), nudge_y = 3) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )

# Year 2022 Bike Popularity for Member Customers - Sans Docked
graph_year2022member_numOfBike_month_biketype_sansDocked <- ggplot(data=yearByMonth_2022_bike_type_Member_subgrouped_sansDocked_df,aes(x=monthNum,y=num_of_bike, fill = biketype)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1))+
  labs(title = "Year 2022 Bike Popularity, Member**",
       subtitle = "Amount of either classic or electic bike used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption = "**This graph does not feature docked bikes, *K stands for 1000") +
  #geom_text(aes(label = signif(num_of_bike)), nudge_y = 3) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  )+
  scale_fill_manual(values = c("#F8766D","#619CFF"))

# Individual
graph_year2022member_numOfBike_month_classic <- ggplot(data=yearByMonth_2022_bike_type_Member_df, aes(x=monthNum,y=classic_bike)) +
  geom_bar(stat = "identity",width=.9,position=position_dodge(width=1), fill = "#F8766D")+
  labs(title = "Year 2022 Bike Popularity, Member - Classic",
       subtitle = "Amount of classic bikes used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(classic_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 

graph_year2022member_numOfBike_month_docked <- ggplot(data=yearByMonth_2022_bike_type_Member_df, aes(x=monthNum,y=docked_bike)) +
  geom_bar(stat = "identity",width=0.9,position=position_dodge(width=1), fill="#00BA38")+
  labs(title = "Year 2022 Bike Popularity, Member - Docked",
       subtitle = "Amount of docked bikes used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(docked_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 


graph_year2022member_numOfBike_month_electric <- ggplot(data=yearByMonth_2022_bike_type_Member_df, aes(x=monthNum,y=electric_bike)) +
  geom_bar(stat = "identity",width=0.9,position=position_dodge(width=1), fill="#619CFF")+
  labs(title = "Year 2022 Bike Popularity, Member - Electric",
       subtitle = "Amount of electric bikes used by Member Customers",
       x="Month",
       y="Amount of Bikes Used (K*)",
       caption="K stands for 1000") +
  geom_text(aes(label = paste(c(floor(electric_bike/ 100)/10)," K",sep="")),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.75,angle=0) +
  scale_y_continuous(limits = c(0,250000) ,labels = label_number(suffix = " K", scale = 1e-3)) +
  scale_x_continuous(
    breaks = seq_along(month.name), 
    labels = month.abb
  ) +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12),
        legend.position = "none"
  ) 

```

```{r APPX: Year 2022 Bike Preferences Member, include=TRUE, eval=FALSE }
graph_year2022member_numOfBike_month_biketype_sansDocked
```

#### <a name="Appx5"/>F.5 Trip Length, Casual vs Member
[Jump to report location this is used](#Ref5)
```{r APPX: Year 2022 Q2 Bike Trip, Casual vs Member, include=TRUE,eval=FALSE}
# Creating a function to properly display time
createTimeStamp = function(input_minute, input_second){
  temp_second = ifelse(input_second < 10,paste("0",input_second,sep = ""),
    as.character(input_second))
  return = paste(input_minute,temp_second,sep = ":")
}

year_2022_q2_df_fixed <- data.frame (member_casual = rep(c("casual","member"),each=7),
                                     day_of_week_num = c(year_2022_qAll_casual_df$day_of_week_num,year_2022_qAll_member_df$day_of_week_num),
                                     Q2 = c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2),
                                     Q2seconds = minute(c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2))*60+second(c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2)),
                                     Q2Text = createTimeStamp(c(minute(c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2))),
                                                              c(second(c(year_2022_qAll_casual_df$Q2,year_2022_qAll_member_df$Q2)))
                                                              )
                                     )



ggplot(data=year_2022_q2_df_fixed,aes(x=day_of_week_num,y=Q2seconds, fill=member_casual))+
  geom_bar(stat = "identity",width=.86,position=position_dodge(width=.9)) +
  labs(title = "Year 2022 Q2 Bike Trip, Casual vs Member",
       subtitle = "The second quantile of casual and member rider's length of time",
       x="Day of the Week",
       y="Length of Trip (HH:MM:SS)")+
  geom_text(aes(label = Q2Text ),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.5,angle=0) +
  scale_y_time(limits = as.hms(c('00:00:00', '00:30:00')))+
  scale_x_continuous(
    breaks = seq_along(days_of_the_week), 
    labels = days_of_the_week
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  ) +
  scale_fill_manual(values = c("orange","violet"),name="Customer")


```

#### <a name="Appx6"/>F.6 Trip Length, Casual - Docked Bikes
[Jump to report location this is used](#Ref6)
```{r APPX: Year 2022 Q2 Bike Trip, Casual - Docked, include=TRUE,eval=FALSE}
## Let's Check docked Bikes Casual

year_2022_clean_casual_docked_bike <- subset(year_2022_clean,member_casual=="casual"& rideable_type=="docked_bike")

#nrow(year_2022_clean_casual_docked_bike) # 176372 
#nrow(subset(year_2022_clean,member_casual=="casual")) #2319783

year_2022_qAll_casual_docked_bike_df <- create_df_q_data(year_2022_clean_casual_docked_bike,"casual")

# Creating a function to properly display time, but this time it uses hour
createTimeStampWHH = function(input_hour,input_minute, input_second){
  temp_minute = ifelse(input_minute < 10,paste("0",input_minute,sep = ""),
                       as.character(input_minute))
  temp_second = ifelse(input_second < 10,paste("0",input_second,sep = ""),
                       as.character(input_second))
  return = ifelse(input_hour == 0,paste(input_minute,temp_second,sep = ":"),paste(input_hour,temp_minute,temp_second,sep = ":"))
    
}

year_2022_q2_casual_docked_bike_df <- data.frame(day_of_week_num = c(year_2022_qAll_casual_docked_bike_df$day_of_week_num),
                                           Q2 = c(year_2022_qAll_casual_docked_bike_df$Q2),
                                           Q2seconds = hour(c(year_2022_qAll_casual_docked_bike_df$Q2))*60*60+minute(c(year_2022_qAll_casual_docked_bike_df$Q2))*60+second(c(year_2022_qAll_casual_docked_bike_df$Q2)),
                                           Q2Text = createTimeStampWHH(c(hour(year_2022_qAll_casual_docked_bike_df$Q2)),
                                                                       c(minute(year_2022_qAll_casual_docked_bike_df$Q2)),
                                                                       c(second(year_2022_qAll_casual_docked_bike_df$Q2))
                                           )
)

ggplot(data=year_2022_q2_casual_docked_bike_df,aes(x=day_of_week_num,y=Q2seconds))+
  geom_bar(stat = "identity",width=.86,position=position_dodge(width=.9), fill="red") +
  labs(title = "Year 2022 Q2 Bike Trip, Casual - Docked",
       subtitle = "The second quantile of casual rider's length of time using docked bikes",
       x="Day of the Week",
       y="Length of Trip (HH:MM:SS)",
       legend="Customer")+
  geom_text(aes(label = Q2Text ),
            position = position_dodge2(width = 0.9, preserve = "single"),size=4.5,hjust= .5,vjust=-.5,angle=0) +
  scale_y_time(limits = as.hms(c('00:00:00', '1:10:00')))+
  scale_x_continuous(
    breaks = seq_along(days_of_the_week), 
    labels = days_of_the_week
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  ) 
```

#### <a name="Appx7"/>F.7 Trip Length, Casual - Docked Bikes vs Member
[Jump to report location this is used](#Ref7)
```{r APPX: Year 2022 Q2 Bike Trip, Casual using Docked vs Member, include=TRUE,eval=FALSE}
# Now let's show it side by side with Members
year_2022_q2_dockedcasualvsmember <- data.frame (member_casual = rep(c("casual","member"),each=7),
                                     day_of_week_num = c(year_2022_q2_casual_docked_bike_df$day_of_week_num,year_2022_qAll_member_df$day_of_week_num),
                                     Q2 = c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2),
                                     Q2seconds = hour(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2))*60*60+minute(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2))*60+second(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2)),
                                     Q2Text = createTimeStampWHH(c(hour(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2))),
                                                                 c(minute(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2))),
                                                                 c(second(c(year_2022_q2_casual_docked_bike_df$Q2,year_2022_qAll_member_df$Q2)))
                                     )
)



ggplot(data=year_2022_q2_dockedcasualvsmember,aes(x=day_of_week_num,y=Q2seconds, fill=member_casual))+
  geom_bar(stat = "identity",width=.86,position=position_dodge(width=.9)) +
  labs(title = "Year 2022 Q2 Bike Trip, Casual using Docked vs Member",
       subtitle = "The second quantile of casual rider's length of time using docked bikes vs member's",
       x="Day of the Week",
       y="Length of Trip (HH:MM:SS)")+
  geom_text(aes(label = Q2Text ),
            position = position_dodge2(width = 0.9, preserve = "single"),size=3.5,hjust= .5,vjust=-.5,angle=0) +
  scale_y_time(limits = as.hms(c('00:00:00', '01:10:00')))+
  scale_x_continuous(
    breaks = seq_along(days_of_the_week), 
    labels = days_of_the_week
  )  +
  theme(plot.title = element_text(size = 18),
        plot.subtitle = element_text(size = 12)
  ) +
  scale_fill_manual(values = c("red","violet"),name="Customer")


```

[Jump to Top](#toc)<br/>